#
# Copyright (c) 2019 Marat Abrarov (abrarov@gmail.com)
#
# Distributed under the MIT License (see accompanying LICENSE)
#

os: windows
language: shell

env:
  global:
    - DOCKER_USER: abrarov

install:
  - powershell -ExecutionPolicy Bypass -File ./install.ps1

script:
  # Full build disabled due to testing and resource consumption
  #- ./travis/run.sh 360 powershell -ExecutionPolicy Bypass -File ./build.ps1 && \
  #- ./travis/run.sh 40 powershell -ExecutionPolicy Bypass -File ./test.ps1
  - ./travis/run.sh 60 powershell -ExecutionPolicy Bypass -File ./docker/windows-dev/build.ps1 && \
  - ./travis/run.sh 20 powershell -ExecutionPolicy Bypass -File ./docker/windows-dev/test.ps1

# Disabled due to testing and AppVeyor (which does the same)
#deploy:
#  skip_cleanup: true
#  provider: script
#  script: powershell -ExecutionPolicy Bypass -File .\deploy.ps1
#  on:
#    branch: master
